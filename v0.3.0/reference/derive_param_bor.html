<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Adds a parameter for best overall response, without confirmation, optionally up to
first progressive disease"><title>Adds a Parameter for Best Overall Response (without confirmation) — derive_param_bor • admiralonco</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Adds a Parameter for Best Overall Response (without confirmation) — derive_param_bor"><meta property="og:description" content="Adds a parameter for best overall response, without confirmation, optionally up to
first progressive disease"><meta property="og:image" content="https://pharmaverse.github.io/admiralonco/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">admiralonco</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/admiralonco.html">Get Started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-user-guides">User Guides</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-user-guides">
    <a class="dropdown-item" href="../articles/adrs.html">Creating ADRS</a>
    <a class="dropdown-item" href="../articles/adtte.html">Creating ADTTE</a>
    <a class="dropdown-item" href="../articles/adtr.html">Creating ADTR</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/pharmaverse/admiralonco" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Adds a Parameter for Best Overall Response (without confirmation)</h1>
      <small class="dont-index">Source: <a href="https://github.com/pharmaverse/admiralonco/blob/main/R/derive_param_bor.R" class="external-link"><code>R/derive_param_bor.R</code></a></small>
      <div class="d-none name"><code>derive_param_bor.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Adds a parameter for best overall response, without confirmation, optionally up to
first progressive disease</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">derive_param_bor</span><span class="op">(</span></span>
<span>  <span class="va">dataset</span>,</span>
<span>  <span class="va">dataset_adsl</span>,</span>
<span>  <span class="va">filter_source</span>,</span>
<span>  source_pd <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  source_datasets <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">reference_date</span>,</span>
<span>  <span class="va">ref_start_window</span>,</span>
<span>  missing_as_ne <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  aval_fun <span class="op">=</span> <span class="va">aval_resp</span>,</span>
<span>  <span class="va">set_values_to</span>,</span>
<span>  subject_keys <span class="op">=</span> <span class="fu">get_admiral_option</span><span class="op">(</span><span class="st">"subject_keys"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dataset</dt>
<dd><p>The input dataframe from which the Best Overall Response will
be derived from and added to.</p>
<p>The columns <code>PARAMCD</code>, <code>ADT</code>, and <code>AVALC</code>and the columns specified in
<code>subject_keys</code> and <code>reference_date</code> are expected.</p>
<p>After applying <code>filter_source</code> and/or <code>source_pd</code> the column <code>ADT</code> and the
columns specified by <code>subject_keys</code> must be a unique key of the dataframe.</p>
<p><em>Permitted Values:</em> a <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame()</a></code> object</p></dd>


<dt>dataset_adsl</dt>
<dd><p>ADSL input dataset.</p>
<p>The columns specified in the subject_keys argument are expected. For each subject in
the passed <code>dataset</code> a new row is added to the input <code>dataset</code>. Columns
in <code>dataset_adsl</code> that also appear in <code>dataset</code> will be populated with the
appropriate subject-specific value for these new rows.</p>
<p><em>Permitted Values:</em> a <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame()</a></code> object</p></dd>


<dt>filter_source</dt>
<dd><p>Filter to be applied to <code>dataset</code> to derive the
Best Overall Response</p></dd>


<dt>source_pd</dt>
<dd><p>Date of first progressive disease (PD)</p>
<p>If the parameter is specified, the observations of the input <code>dataset</code> for
deriving the new parameter are restricted to observations up to the
specified date. Observations at the specified date are included. For
subjects without first PD date all observations are take into account.</p>
<p><em>Permitted Values:</em> a <code>date_source</code> object (see <code><a href="https://rdrr.io/pkg/admiral/man/date_source.html" class="external-link">date_source()</a></code>
for details)</p></dd>


<dt>source_datasets</dt>
<dd><p>Source dataframe to be used to calculate the
first PD date</p>
<p>A named list of dataframes is expected (although for BOR) only one dataframe is
needed. It links the <code>dataset_name</code> from <code>source_pd</code> with an existing dataframe.</p>
<p>For example if <code>source_pd = pd_date</code> with</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">pd_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/admiral/man/date_source.html" class="external-link">date_source</a></span><span class="op">(</span></span>
<span>  dataset_name <span class="op">=</span> <span class="st">"adrs"</span>,</span>
<span>  date <span class="op">=</span> <span class="va">ADT</span>,</span>
<span>  filter <span class="op">=</span> <span class="va">PARAMCD</span> <span class="op">==</span> <span class="va">PD</span></span>
<span><span class="op">)</span></span></code></pre><p></p></div>
<p>and the actual response dataframe in the script is <code>myadrs</code>, <code>source_datasets = list(adrs = myadrs)</code> should be specified.</p></dd>


<dt>reference_date</dt>
<dd><p>Reference date</p>
<p>The reference date is used along with <code>ref_start_window</code> to determine those
records that occur before and after <code>ADT</code> (see Details section for further
information). Usually it is treatment start date (<code>TRTSDT</code>) or
randomization date (<code>RANDDT</code>).</p>
<p><em>Permitted Values:</em> a numeric date column</p></dd>


<dt>ref_start_window</dt>
<dd><p>Stable disease time window</p>
<p>The ref_start_window is used along with <code>reference_date</code> to determine those
records that occur before and after <code>ADT</code> (i.e. for a record determine
whether <code>ADT</code> &gt;= <code>reference_date</code> + <code>ref_start_window</code>),
see Details section for further information.</p>
<p><em>Permitted Values:</em> a non-negative numeric scalar</p></dd>


<dt>missing_as_ne</dt>
<dd><p>Consider no assessments as <code>"NE"</code>?</p>
<p>If the argument is set to <code>TRUE</code>, the response is set to <code>"NE"</code> for
subjects in <code>dataset_adsl</code> without an assessment in the <code>dataset</code> after the
filter has been applied. Otherwise, the response is set to <code>"MISSING"</code>
for these subjects.</p>
<p><em>Permitted Values:</em> a logical scalar</p></dd>


<dt>aval_fun</dt>
<dd><p>Function to map character analysis value (<code>AVALC</code>) to numeric
analysis value (<code>AVAL</code>)</p>
<p>The (first) argument of the function must expect a character vector and the
function must return a numeric vector.</p></dd>


<dt>set_values_to</dt>
<dd><p>New columns to set</p>
<p>A named list returned by <code><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs()</a></code> defining the columns to be set for the
new parameter, e.g. <code>exprs(PARAMCD = "BOR", PARAM = "Best Overall Response")</code> is expected. The values must be symbols, character strings,
numeric values, or <code>NA</code>.</p></dd>


<dt>subject_keys</dt>
<dd><p>Columns to uniquely identify a subject</p>
<p><em>Permitted Values:</em> A list of symbols created using <code><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The dataframe passed in the <code>dataset</code> argument with additional columns and/or
rows as set in the <code>set_values_to</code> argument.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Calculates the best overall response (BOR) parameter, as detailed below.</p>
<p>Records after PD can be removed using the source_pd and source_datasets
arguments.</p>
<p>Note:</p><ol><li><p>All <code>CR</code>, <code>PR</code> and <code>PD</code> response records are considered for Best Overall Response.</p></li>
<li><p>All <code>SD</code> or <code>NON-CR/NON-PD</code> records where <code>ADT</code> &gt;= <code>reference_date</code> +
<code>ref_start_window</code> are also considered for Best Overall Response.</p></li>
<li><p>Subjects with <strong>ONLY</strong> an <code>SD</code> or <code>NON-CR/NON-PD</code> records where <code>ADT</code> &lt;
<code>reference_date</code> + <code>ref_start_window</code> are assigned a Best Overall Response of <code>NE</code>.</p></li>
<li><p>The Best Response, from the records in steps 1 to 3, is then selected in the following
order of preference: CR, PR, SD, NON-CR/NON-PD, PD, NE, MISSING</p></li>
<li><p>The <code>AVAL</code> column is added and set using the <code>aval_fun(AVALC)</code> function</p></li>
<li><p>The columns specified by the <code>set_values_to</code> parameter and records
are added to the dataframe passed into the <code>dataset</code> argument</p></li>
</ol><p>Note: Any responses of SD or NON-CR/NON-PD that occur before <code>reference_date</code> +
<code>ref_start_window</code> are ignored in the calculation of BOR. All other responses are included
in the calculation of BOR, irrespective of the number of days from the reference date.</p>
<p>Also Note: All columns from the input dataset are kept. For subjects with no records in
the input dataset (after the filter is applied) all columns are kept from ADSL which are
also in the input dataset.  Columns which are not to be populated for the new parameter
or populated differently (e.g. <code>RSSTRESC</code>, <code>VISIT</code>, <code>PARCATy</code>, <code>ANLzzFL</code>, ...) should be
overwritten using the <code>set_values_to</code> parameter.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>ADRS Functions for adding Parameters: 
<code><a href="derive_param_clinbenefit.html">derive_param_clinbenefit</a>()</code>,
<code><a href="derive_param_confirmed_bor.html">derive_param_confirmed_bor</a>()</code>,
<code><a href="derive_param_confirmed_resp.html">derive_param_confirmed_resp</a>()</code>,
<code><a href="derive_param_response.html">derive_param_response</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Stephen Gormley</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘lubridate’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     date, intersect, setdiff, union</span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pharmaverse.github.io/admiral/" class="external-link">admiral</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘admiral’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:dplyr’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     vars</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:admiralonco’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     death_event, lastalive_censor</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create ADSL dataset</span></span></span>
<span class="r-in"><span><span class="va">adsl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">TRTSDTC</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1"</span>,      <span class="st">"2020-01-01"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"2"</span>,      <span class="st">"2019-12-12"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"3"</span>,      <span class="st">"2019-11-11"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"4"</span>,      <span class="st">"2019-12-30"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"5"</span>,      <span class="st">"2020-01-01"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"6"</span>,      <span class="st">"2020-02-02"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"7"</span>,      <span class="st">"2020-02-02"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"8"</span>,      <span class="st">"2020-04-01"</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    TRTSDT <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="va">TRTSDTC</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    STUDYID <span class="op">=</span> <span class="st">"XX1234"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create ADRS dataset</span></span></span>
<span class="r-in"><span><span class="va">ovr_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">ADTC</span>, <span class="op">~</span><span class="va">AVALC</span>, <span class="op">~</span><span class="va">ANL01FL</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1"</span>, <span class="st">"2020-01-01"</span>, <span class="st">"PR"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1"</span>, <span class="st">"2020-02-01"</span>, <span class="st">"CR"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1"</span>, <span class="st">"2020-02-16"</span>, <span class="st">"NE"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1"</span>, <span class="st">"2020-03-01"</span>, <span class="st">"CR"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1"</span>, <span class="st">"2020-04-01"</span>, <span class="st">"SD"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"2"</span>, <span class="st">"2020-01-01"</span>, <span class="st">"SD"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"2"</span>, <span class="st">"2020-02-01"</span>, <span class="st">"PR"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"2"</span>, <span class="st">"2020-03-01"</span>, <span class="st">"SD"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"2"</span>, <span class="st">"2020-03-13"</span>, <span class="st">"CR"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"3"</span>, <span class="st">"2019-11-12"</span>, <span class="st">"CR"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"3"</span>, <span class="st">"2019-12-02"</span>, <span class="st">"CR"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"3"</span>, <span class="st">"2020-01-01"</span>, <span class="st">"SD"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"4"</span>, <span class="st">"2020-01-01"</span>, <span class="st">"PR"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"4"</span>, <span class="st">"2020-03-01"</span>, <span class="st">"SD"</span>, <span class="st">"N"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"4"</span>, <span class="st">"2020-04-01"</span>, <span class="st">"SD"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"4"</span>, <span class="st">"2020-05-01"</span>, <span class="st">"PR"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"4"</span>, <span class="st">"2020-05-15"</span>, <span class="st">"NON-CR/NON-PD"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"5"</span>, <span class="st">"2020-01-01"</span>, <span class="st">"PR"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"5"</span>, <span class="st">"2020-01-10"</span>, <span class="st">"SD"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"5"</span>, <span class="st">"2020-01-20"</span>, <span class="st">"PR"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"5"</span>, <span class="st">"2020-05-15"</span>, <span class="st">"NON-CR/NON-PD"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"6"</span>, <span class="st">"2020-02-06"</span>, <span class="st">"PR"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"6"</span>, <span class="st">"2020-02-16"</span>, <span class="st">"CR"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"6"</span>, <span class="st">"2020-03-30"</span>, <span class="st">"PR"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"6"</span>, <span class="st">"2020-04-12"</span>, <span class="st">"PD"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"6"</span>, <span class="st">"2020-05-01"</span>, <span class="st">"CR"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"6"</span>, <span class="st">"2020-06-01"</span>, <span class="st">"CR"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"7"</span>, <span class="st">"2020-02-06"</span>, <span class="st">"PR"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"7"</span>, <span class="st">"2020-02-16"</span>, <span class="st">"CR"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"7"</span>, <span class="st">"2020-04-01"</span>, <span class="st">"NE"</span>, <span class="st">"N"</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>PARAMCD <span class="op">=</span> <span class="st">"OVR"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pd_obs</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">ADTC</span>,        <span class="op">~</span><span class="va">AVALC</span>,</span></span>
<span class="r-in"><span>    <span class="st">"2"</span>,      <span class="st">"2020-03-01"</span>, <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"4"</span>,      <span class="st">"2020-02-01"</span>, <span class="st">"Y"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>PARAMCD <span class="op">=</span> <span class="st">"PD"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">adrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">ovr_obs</span>, <span class="va">pd_obs</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    ADT <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="va">ADTC</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    STUDYID <span class="op">=</span> <span class="st">"XX1234"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">ADTC</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/admiral/man/derive_vars_merged.html" class="external-link">derive_vars_merged</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    dataset_add <span class="op">=</span> <span class="va">adsl</span>,</span></span>
<span class="r-in"><span>    by_vars     <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">STUDYID</span>, <span class="va">USUBJID</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    new_vars    <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">TRTSDT</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pd_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/admiral/man/date_source.html" class="external-link">date_source</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  dataset_name <span class="op">=</span> <span class="st">"adrs"</span>,</span></span>
<span class="r-in"><span>  date         <span class="op">=</span> <span class="va">ADT</span>,</span></span>
<span class="r-in"><span>  filter       <span class="op">=</span> <span class="va">PARAMCD</span> <span class="op">==</span> <span class="st">"PD"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">aval_fun_pass</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">arg</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">arg</span> <span class="op">==</span> <span class="st">"CR"</span> <span class="op">~</span> <span class="fl">11</span>,</span></span>
<span class="r-in"><span>    <span class="va">arg</span> <span class="op">==</span> <span class="st">"PR"</span> <span class="op">~</span> <span class="fl">22</span>,</span></span>
<span class="r-in"><span>    <span class="va">arg</span> <span class="op">==</span> <span class="st">"SD"</span> <span class="op">~</span> <span class="fl">33</span>,</span></span>
<span class="r-in"><span>    <span class="va">arg</span> <span class="op">==</span> <span class="st">"NON-CR/NON-PD"</span> <span class="op">~</span> <span class="fl">44</span>,</span></span>
<span class="r-in"><span>    <span class="va">arg</span> <span class="op">==</span> <span class="st">"PD"</span> <span class="op">~</span> <span class="fl">55</span>,</span></span>
<span class="r-in"><span>    <span class="va">arg</span> <span class="op">==</span> <span class="st">"NE"</span> <span class="op">~</span> <span class="fl">66</span>,</span></span>
<span class="r-in"><span>    <span class="va">arg</span> <span class="op">==</span> <span class="st">"MISSING"</span> <span class="op">~</span> <span class="fl">77</span>,</span></span>
<span class="r-in"><span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_real_</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Derive best overall response parameter</span></span></span>
<span class="r-in"><span><span class="fu">derive_param_bor</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">adrs</span>,</span></span>
<span class="r-in"><span>  dataset_adsl <span class="op">=</span> <span class="va">adsl</span>,</span></span>
<span class="r-in"><span>  filter_source <span class="op">=</span> <span class="va">PARAMCD</span> <span class="op">==</span> <span class="st">"OVR"</span> <span class="op">&amp;</span> <span class="va">ANL01FL</span> <span class="op">==</span> <span class="st">"Y"</span>,</span></span>
<span class="r-in"><span>  source_pd <span class="op">=</span> <span class="va">pd_date</span>,</span></span>
<span class="r-in"><span>  source_datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adrs <span class="op">=</span> <span class="va">adrs</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  aval_fun <span class="op">=</span> <span class="va">aval_fun_pass</span>,</span></span>
<span class="r-in"><span>  reference_date <span class="op">=</span> <span class="va">TRTSDT</span>,</span></span>
<span class="r-in"><span>  ref_start_window <span class="op">=</span> <span class="fl">28</span>,</span></span>
<span class="r-in"><span>  set_values_to <span class="op">=</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">exprs</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    PARAMCD <span class="op">=</span> <span class="st">"BOR"</span>,</span></span>
<span class="r-in"><span>    PARAM <span class="op">=</span> <span class="st">"Best Overall Response"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">PARAMCD</span> <span class="op">==</span> <span class="st">"BOR"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 8 x 9</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   USUBJID AVALC  ANL01FL PARAMCD ADT        STUDYID TRTSDT     PARAM        AVAL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>  </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;date&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>   </span><span style="color: #949494;font-style: italic;">&lt;date&gt;</span><span>     </span><span style="color: #949494;font-style: italic;">&lt;chr&gt;</span><span>       </span><span style="color: #949494;font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span><span> 1       CR     Y       BOR     2020-02-01 XX1234  2020-01-01 Best Overa…    11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span><span> 2       PR     Y       BOR     2020-02-01 XX1234  2019-12-12 Best Overa…    22</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span><span> 3       CR     Y       BOR     2019-11-12 XX1234  2019-11-11 Best Overa…    11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span><span> 4       PR     Y       BOR     2020-01-01 XX1234  2019-12-30 Best Overa…    22</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span><span> 5       PR     Y       BOR     2020-01-01 XX1234  2020-01-01 Best Overa…    22</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span><span> 6       CR     Y       BOR     2020-02-16 XX1234  2020-02-02 Best Overa…    11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span><span> 7       CR     Y       BOR     2020-02-16 XX1234  2020-02-02 Best Overa…    11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">8</span><span> 8       MISSI… </span><span style="color: #BB0000;">NA</span><span>      BOR     </span><span style="color: #BB0000;">NA</span><span>         XX1234  2020-04-01 Best Overa…    77</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Stefan Bundfuss, Ross Farrugia, Amit Jain, Andrew Smith, Teckla Akinyi, Samia Kabi, Stephen Gormley, Hinal Patel, F. Hoffmann-La Roche AG, GlaxoSmithKline LLC, Amgen Inc., Bristol Myers Squibb.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

